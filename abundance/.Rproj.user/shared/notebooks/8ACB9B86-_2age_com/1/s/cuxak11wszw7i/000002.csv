"0",""
"0","# to apportion creel census catch by sex"
"0","creel$RvrCatchApportioned <- Map(f = function(y, r, cc = census_count) {"
"0","  "
"0","  # nothing to do"
"0","  if (length(r) == 0) return(NULL)"
"0","  "
"0","  # for subsetting inputs"
"0","  b <- cc[[""CYear""]] %in% y  & cc[[""Type""]] %in% ""rvr"""
"0","  "
"0","  # for matching with census_count (i.e., total catch)"
"0","  dnms <- dimnames(r)"
"0","  i <- match(as.numeric(dnms[[1]]), table = cc[b, ""Month""])"
"0","  "
"0","  # to apportion catch given proportion of males & females"
"0","  o <- cc[b, ""CatchSum""][i] * r"
"0","  "
"0","  # to deal with left over to avoid fractions of fish; if leftover for male is"
"0","  # greater, then 1 goes to male, otherwise female; leftover should sum to"
"0","  # either NA, 0, or 1"
"0","  lo <- t(apply(o %% 1, MARGIN = 1, FUN = function(x) {"
"0","    if (all(is.na(x))) return(c(NA, NA))"
"0","    # sum(x) should now either be 1 or 0"
"0","    s <- sum(x)"
"0","    res <- c(0, s)"
"0","    if (x[1] > x[2]) res <- c(s, 0)"
"0","    res"
"0","  }))"
"0","  "
"0","  # final result in whole numbers"
"0","  (o %/% 1) + lo"
"0","  "
"0","}, creel[[""CYear""]], creel[[""RiverPropBySex""]])"
"0",""
