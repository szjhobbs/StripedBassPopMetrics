"0",""
"0","# need to subset on no sub-legal sized fish & for bay creel - monthly cutoff"
"0","# lengths found in creel$MonthlyCutoff"
"0",""
"0","creel$RAC <- Map(f = function(s, mc) {"
"0","  "
"0","  lapply(s[[""Data""]], FUN = function(d) {"
"0","    "
"0","    # to process by creel type for getting summary by month"
"0","    tt <- Split("
"0","      data = d,"
"0","      subset = !LenCat %in% ""sub"","
"0","      vars = c(Month, ForkLen, Ages),"
"0","      splitVars = Type"
"0","    )"
"0","    "
"0","    Map(f = function(dd, type) {"
"0","      "
"0","      # check for bay creel"
"0","      if (type %in% ""bay"") {"
"0","        use <- rep(TRUE, times = nrow(dd))"
"0","        m <- month.abb[dd[[""Month""]]]"
"0","        i <- match(m, table = names(mc))"
"0","        b <- dd[[""ForkLen""]] >= mc[i]"
"0","        use[!b] <- FALSE"
"0","        "
"0","        # for ordering, although numerically this should order as desired"
"0","        dd$Month <- factor(dd[[""Month""]], levels = 6:12)"
"0","        "
"0","        out <- list("
"0","          AgeMonth = table(dd[use, ""Ages""], dd[use, ""Month""]),"
"0","          MeasCutoff = table(dd[use, ""Month""]),"
"0","          Measured = table(dd[[""Month""]])"
"0","        )"
"0","        return(out)"
"0","      }"
"0","      "
"0","      # what's left is river creel"
"0","      "
"0","      # because protocol states ages from Dec-Mar are increased by 1 (year)"
"0","      b <- dd[[""Month""]] %in% c(12, 1:3)"
"0","      dd[b, ""Ages""] <- dd[b, ""Ages""] + 1"
"0","      "
"0","      # for desired ordering as Dec (12) is from previous year"
"0","      dd$Month <- factor(dd[[""Month""]], levels = c(12, 1:6))"
"0","      "
"0","      # output for river creel"
"0","      list("
"0","        AgeMonth = table(dd[[""Ages""]], dd[[""Month""]]),"
"0","        Measured = table(dd[[""Month""]])"
"0","      )"
"0","      "
"0","    }, tt[[""Data""]], tt[[""Type""]])"
"0","    "
"0","  })"
"0","  # end lapply"
"0","  "
"0","}, creel[[""BySex""]], creel[[""MonthlyCutoff""]])"
"0",""
