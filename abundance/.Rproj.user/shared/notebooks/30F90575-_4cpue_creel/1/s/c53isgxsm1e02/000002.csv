"0",""
"0","# because we only need the data variable CYear & Month already exist in cc_cpue"
"0","cc_cpue$Data <- Split("
"0","  data = cc_split, "
"0","  vars = CPUE, "
"0","  splitVars = c(CYear, Month), "
"0","  drop = TRUE"
"0",")[[""Data""]]"
"0",""
"0","# to get ratio of records with 0 catch to all records"
"0","cc_cpue$Ratio0 <- t(vapply(cc_cpue[[""Data""]], FUN = function(d) {"
"0","  # return(nrow(d))"
"0","  b <- d[[""CPUE""]][, ""Catch""] %in% 0"
"0","  if (all(!b)) return(c(Ratio = 1, Recs = nrow(d)))"
"0","  a0 <- sum(d[[""CPUE""]][b, ""Anglers""], na.rm = F)"
"0","  a <- sum(d[[""CPUE""]][, ""Anglers""], na.rm = F)"
"0","  c(Ratio = a0 / a, Recs = nrow(d))"
"0","}, FUN.VALUE = numeric(2L)))"
"0",""
