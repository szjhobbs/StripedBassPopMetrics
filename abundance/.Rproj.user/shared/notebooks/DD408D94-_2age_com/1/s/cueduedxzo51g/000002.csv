"0",""
"0","creel$BayAgeCom <- Map(f = function(pam, app) {"
"0","  "
"0","  sex <- c('m', 'f')"
"0","  "
"0","  out <- lapply(sex, FUN = function(s) {"
"0","    "
"0","    dnms <- dimnames(pam[[s]])"
"0","    "
"0","    n <- length(dnms[[1]])"
"0","    "
"0","    vapply(dnms[[2]], FUN = function(dn) {"
"0","      p <- pam[[s]][, dn]"
"0","      size <- app[dn, s]"
"0","      "
"0","      if (is.na(size)) {"
"0","        na <- rep(NA, times = n)"
"0","        names(na) <- dnms[[1]]"
"0","        return(na)"
"0","      o <- size * p"
"0","      "
"0","      # to get sample size for sampling below"
"0","      "
"0","      # to get ages for sampling"
"0","      a <- as.numeric(names(p))"
"0","      r <- sample(a, size = sz, replace = TRUE, prob = p)"
"0","      # r <- sample(a, size = size, replace = TRUE, prob = p)"
"0","      "
"0","      # to add back to whole number of size * p"
"0","      r <- factor(r, levels = dnms[[1]])"
"0","      table(r) + (o %/% 1)"
"0","      "
"0","    }, FUN.VALUE = numeric(n))"
"0","    # end vapply"
"0",""
"0","  })"
"0","  # end lapply"
"0","  names(out) <- sex"
"0","  out"
"0","  "
"0","}, creel[[""BayPropAgeMonth""]], creel[[""BayCatchApportioned""]])"
"0",""
