"0",""
"0","catch$CumR <- lapply(catch[[""RelYear""]], FUN = function(y) {"
"0","  "
"0","  # for looping through sex"
"0","  sex <- c(m = 'm', f = 'f')"
"0","  "
"0","  lapply(sex, FUN = function(s) {"
"0","    "
"0","    # to get data from desired year"
"0","    yi <- setNames(object = y + 0:4, nm = y + 0:4)"
"0","    "
"0","    # to hold the carry over C after each year's update"
"0","    co <- 0L"
"0","    "
"0","    lapply(yi, FUN = function(i) {"
"0","      "
"0","      # for subsetting bay creel on initial year"
"0","      ic <- as.character(y)"
"0","      "
"0","      bcy0 <- 0L"
"0","      age3_to_zero <- TRUE"
"0","      "
"0","      if (ic %in% dimnames(catch[[""BayR""]][[ic]][[s]])[[2]])"
"0","        bcy0 <- catch[[""BayR""]][[ic]][[s]][, ic]"
"0","      "
"0","      # for the first year's estimate only bay creel is needed"
"0","      if (i == y) return(bcy0)"
"0","      "
"0","      # for indexing to follow (to get update year's data)"
"0","      i <- as.character(i)"
"0","      "
"0","      # because we did not tag every year we need to set 0s for years in which"
"0","      # we did not tag, could be NA, but that make the math more challenging"
"0","      # nms <- dimnames(catch[[""TagR""]][[ic]][[s]])[[2]]"
"0","      # tg <- rep(0, times = 6L)"
"0","      tg <- 0L"
"0","      if (i %in% dimnames(catch[[""TagR""]][[ic]][[s]])[[2]])"
"0","        tg <- catch[[""TagR""]][[ic]][[s]][, i]"
"0","      "
"0","      # to get river (rc) & bay (bc) creel data"
"0","      rc <- 0L"
"0","      if (i %in% dimnames(catch[[""RvrR""]][[ic]][[s]])[[2]])"
"0","        rc <- catch[[""RvrR""]][[ic]][[s]][, i]"
"0","      "
"0","      bc <- 0L"
"0","      if (i %in% dimnames(catch[[""BayR""]][[ic]][[s]])[[2]])"
"0","        bc <- catch[[""BayR""]][[ic]][[s]][, i]"
"0","      "
"0","      # because age3 fish from bay creel (estimate year) are not included"
"0","      # bcy0[[""3""]] <- 0L"
"0","      # bcy0[[1]] <- 0L"
"0","      if (age3_to_zero) bcy0[[1]] <- 0L"
"0","      "
"0","      # output "
"0","      out <- cbind("
"0","        URvr = co + bcy0 + rc,"
"0","        UTag = co + bcy0 + rc + tg,"
"0","        UBay = co + bcy0 + rc + tg + bc"
"0","      )"
"0","      "
"0","      # to update carry over with each of the 4 annual updates"
"0","      co <<- out[, ""UBay""] - bcy0"
"0","      "
"0","      out"
"0","    })"
"0","    # end second inner lapply"
"0","  })"
"0","  # end first inner lapply"
"0","})"
"0","# end outer lapply"
"0",""
